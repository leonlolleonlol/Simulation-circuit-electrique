<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>correctif_automatique.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/leonlolleonlol/Simulation-circuit-electrique" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="Ampoule.html">Ampoule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Ampoule.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Ampoule.html#setProchaineComposante">setProchaineComposante</a></li></ul></li><li><a href="Batterie.html">Batterie</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Batterie.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Batterie.html#setProchaineComposante">setProchaineComposante</a></li></ul></li><li><a href="Circuit.html">Circuit</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Circuit.html#ajouterComposante">ajouterComposante</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#connectComposante">connectComposante</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#echangerComposantes">echangerComposantes</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#getCircuit">getCircuit</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#getCircuits">getCircuits</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#getTypeDeCircuit">getTypeDeCircuit</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#noeudEq">noeudEq</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#rearrangerArrayCircuit">rearrangerArrayCircuit</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#remplirCondensateursAvecCharge">remplirCondensateursAvecCharge</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#remplirResisteursAvecCourant">remplirResisteursAvecCourant</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#retirerComposante">retirerComposante</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#setSymbol">setSymbol</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#solveCourrantkirchhoff">solveCourrantkirchhoff</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#trouverEq">trouverEq</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#trouverPile">trouverPile</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#trouverTypeDeCircuit">trouverTypeDeCircuit</a></li><li data-type='method' style='display: none;'><a href="Circuit.html#update">update</a></li></ul></li><li><a href="Composant.html">Composant</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Composant.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Composant.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Composant.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Composant.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Composant.html#setProchaineComposante">setProchaineComposante</a></li></ul></li><li><a href="Condensateur.html">Condensateur</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Condensateur.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Condensateur.html#setProchaineComposante">setProchaineComposante</a></li></ul></li><li><a href="Diode.html">Diode</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Diode.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Diode.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Diode.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Diode.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Diode.html#setProchaineComposante">setProchaineComposante</a></li></ul></li><li><a href="Fil.html">Fil</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Fil.html#angle">angle</a></li><li data-type='method' style='display: none;'><a href="Fil.html#getFunction">getFunction</a></li><li data-type='method' style='display: none;'><a href="Fil.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Fil.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Fil.html#inBoxBounds">inBoxBounds</a></li><li data-type='method' style='display: none;'><a href="Fil.html#intersection">intersection</a></li><li data-type='method' style='display: none;'><a href="Fil.html#longueur">longueur</a></li><li data-type='method' style='display: none;'><a href="Fil.html#overlap">overlap</a></li><li data-type='method' style='display: none;'><a href="Fil.html#pente">pente</a></li><li data-type='method' style='display: none;'><a href="Fil.html#trierPoint">trierPoint</a></li></ul></li><li><a href="Noeuds.html">Noeuds</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Noeuds.html#ajouterComposante">ajouterComposante</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#maille">maille</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#remplirCondensateursAvecTension">remplirCondensateursAvecTension</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#remplirResisteursAvecDifTension">remplirResisteursAvecDifTension</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#setProchaineComposante">setProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#trouverEq">trouverEq</a></li><li data-type='method' style='display: none;'><a href="Noeuds.html#trouverTypeDeCircuit">trouverTypeDeCircuit</a></li></ul></li><li><a href="Resisteur.html">Resisteur</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Resisteur.html#checkConnection">checkConnection</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getBorne">getBorne</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getConnection">getConnection</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getConnections">getConnections</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getProchaineComposante">getProchaineComposante</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getTitle">getTitle</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#getType">getType</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#inBounds">inBounds</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#rotate">rotate</a></li><li data-type='method' style='display: none;'><a href="Resisteur.html#setProchaineComposante">setProchaineComposante</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#AMPOULE">AMPOULE</a></li><li><a href="global.html#BAS">BAS</a></li><li><a href="global.html#BATTERIE">BATTERIE</a></li><li><a href="global.html#CIRCUIT">CIRCUIT</a></li><li><a href="global.html#CONDENSATEUR">CONDENSATEUR</a></li><li><a href="global.html#CREATE">CREATE</a></li><li><a href="global.html#DIODE">DIODE</a></li><li><a href="global.html#DROITE">DROITE</a></li><li><a href="global.html#FIL">FIL</a></li><li><a href="global.html#FunctionObject">FunctionObject</a></li><li><a href="global.html#GAUCHE">GAUCHE</a></li><li><a href="global.html#HAUT">HAUT</a></li><li><a href="global.html#MODIFIER">MODIFIER</a></li><li><a href="global.html#NOEUD">NOEUD</a></li><li><a href="global.html#POINT">POINT</a></li><li><a href="global.html#QUADRILLE">QUADRILLE</a></li><li><a href="global.html#QUADRILLEPOINT">QUADRILLEPOINT</a></li><li><a href="global.html#RESISTEUR">RESISTEUR</a></li><li><a href="global.html#SUPPRIMER">SUPPRIMER</a></li><li><a href="global.html#addActions">addActions</a></li><li><a href="global.html#ajustementAutomatiqueComposant">ajustementAutomatiqueComposant</a></li><li><a href="global.html#ajustementAutomatiqueFil">ajustementAutomatiqueFil</a></li><li><a href="global.html#ampoule">ampoule</a></li><li><a href="global.html#appliquerTransformation">appliquerTransformation</a></li><li><a href="global.html#applyLimitActions">applyLimitActions</a></li><li><a href="global.html#batterie">batterie</a></li><li><a href="global.html#blendBG">blendBG</a></li><li><a href="global.html#circuitMaille">circuitMaille</a></li><li><a href="global.html#condensateur">condensateur</a></li><li><a href="global.html#copyComposant">copyComposant</a></li><li><a href="global.html#couperFil">couperFil</a></li><li><a href="global.html#createColorGradient">createColorGradient</a></li><li><a href="global.html#diode">diode</a></li><li><a href="global.html#draw">draw</a></li><li><a href="global.html#drawComponentsChooser">drawComponentsChooser</a></li><li><a href="global.html#drawFils">drawFils</a></li><li><a href="global.html#drawGrid">drawGrid</a></li><li><a href="global.html#drawNoeuds">drawNoeuds</a></li><li><a href="global.html#filStart">filStart</a></li><li><a href="global.html#findGridLock">findGridLock</a></li><li><a href="global.html#getAllConnection">getAllConnection</a></li><li><a href="global.html#getConnectingComposant">getConnectingComposant</a></li><li><a href="global.html#getPossibleConnections">getPossibleConnections</a></li><li><a href="global.html#getStringData">getStringData</a></li><li><a href="global.html#inGrid">inGrid</a></li><li><a href="global.html#initDrag">initDrag</a></li><li><a href="global.html#isElementDrag">isElementDrag</a></li><li><a href="global.html#isElementSelectionner">isElementSelectionner</a></li><li><a href="global.html#lineGrid">lineGrid</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#loadLocalCircuit">loadLocalCircuit</a></li><li><a href="global.html#mouseDragged">mouseDragged</a></li><li><a href="global.html#mousePressed">mousePressed</a></li><li><a href="global.html#mouseReleased">mouseReleased</a></li><li><a href="global.html#mouseWheel">mouseWheel</a></li><li><a href="global.html#pointGrid">pointGrid</a></li><li><a href="global.html#posAtPercent">posAtPercent</a></li><li><a href="global.html#redo">redo</a></li><li><a href="global.html#resetHistorique">resetHistorique</a></li><li><a href="global.html#resisteur">resisteur</a></li><li><a href="global.html#sauvegarder">sauvegarder</a></li><li><a href="global.html#selectionBox">selectionBox</a></li><li><a href="global.html#setModificationFilPos">setModificationFilPos</a></li><li><a href="global.html#setTooltip">setTooltip</a></li><li><a href="global.html#splitFil">splitFil</a></li><li><a href="global.html#telecharger">telecharger</a></li><li><a href="global.html#undo">undo</a></li><li><a href="global.html#updateBouton">updateBouton</a></li><li><a href="global.html#updateFilPos">updateFilPos</a></li><li><a href="global.html#updateNoeud">updateNoeud</a></li><li><a href="global.html#upload">upload</a></li><li><a href="global.html#validBoutonActif">validBoutonActif</a></li><li><a href="global.html#validComposantPos">validComposantPos</a></li><li><a href="global.html#validFilBegin">validFilBegin</a></li><li><a href="global.html#validerAction">validerAction</a></li><li><a href="global.html#verifierCouperFil">verifierCouperFil</a></li><li><a href="global.html#verifierCouperNoeud">verifierCouperNoeud</a></li><li><a href="global.html#verifierSplitNewComposant">verifierSplitNewComposant</a></li><li><a href="global.html#windowResized">windowResized</a></li><li><a href="global.html#zoom">zoom</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">correctif_automatique.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Effectue les ajustements automatique après la création d'un nouveau fil par l'utilisateur.
 * 1. Ordonner les points initiaux et finaux plus petit au plus grand (xi doit être &lt; que xf)
 * 2. Unir certains fils possible en un seul fil
 * 3. Coupe le fil dépendant des composants par lequel il passe
 * 4. Coupe le fil pour respecter les noeuds
 * @param {Fil} fil Le nouveau fil
 * @param {Array} actions La liste d'actions ou l'on va enregistrer les actions interne 
 * effectuer dans la fonction
 */
function ajustementAutomatiqueFil(fil, actions) {
  fil.trierPoint();
  for (let index = 0; index &lt; fils.length; index++) {
    const testFil = fils[index];
    if (testFil !== fil &amp;&amp; fil.overlap(testFil)) {
      let array = [{ x: testFil.xi, y: testFil.yi }, { x: testFil.xf, y: testFil.yf },
      { x: fil.xi, y: fil.yi }, { x: fil.xf, y: fil.yf }];
      if (Math.abs(testFil.pente()) == Infinity)
        array.sort(function (a, b) { return a.y - b.y });
      else array.sort(function (a, b) { return a.x - b.x });
      fil.xi = array[0].x;
      fil.yi = array[0].y;
      fil.xf = array[array.length - 1].x;
      fil.yf = array[array.length - 1].y;
      fils.splice(index, 1);
      actions.push({ type: SUPPRIMER, objet: testFil, index });
      index--;
    }
  }
  verifierCouperFil(fil, actions);
  verifierCouperNoeud(fil, actions);
}

/**
 * Cette fonction permet de faire les appels pour la fonctions couperFil pour chaque composant.
 * Elle a été créer pour nous permettre d'éviter lorsque l'on créer dans la fonction couperFil
 * un nouveau fil de répasser par la fonction ajustementNouveauFil au complet.
 * @param {Fil} fil Le fil à vérifier
 * @param {Array} actions La liste d'actions ou l'on va enregistrer les actions interne 
 * effectuer dans la fonction
 */
function verifierCouperFil(fil, actions) {
  if (fil.isPenteConstante()) {
    for (const composant of components) {
      let continuer = couperFil(fil, composant, actions);
      if (!continuer)
        return;
    }
  }
}


/**
 * Vérifie si un fil à besoin d'être coupé pour connecter à un composant ou un autre fil.
 * @param {Fil} fil Le fil à vérifier
 * @param {Array} actions La liste d'action à enregistrer dans l'historique
 */
function verifierCouperNoeud(fil, actions) {
  for (let index = 0; index &lt; fils.length; index++) {
    const element = fils[index];
    if (element != fil &amp;&amp; fil.isPenteConstante() &amp;&amp; element.isPenteConstante()) {
      let pointIntersect = element.intersection(fil);
      if (pointIntersect != null) {
        if (!((element.xi == pointIntersect.x &amp;&amp; element.yi == pointIntersect.y) ||
          (element.xf == pointIntersect.x &amp;&amp; element.yf == pointIntersect.y))) {
          splitFil(element, actions, pointIntersect);
          index--;
        }
        if (!((fil.xi == pointIntersect.x &amp;&amp; fil.yi == pointIntersect.y) ||
          (fil.xf == pointIntersect.x &amp;&amp; fil.yf == pointIntersect.y))) {
          let newFils = splitFil(fil, actions, pointIntersect);
          verifierCouperNoeud(newFils[0], actions);
          verifierCouperNoeud(newFils[1], actions);
          return;
        }
      }
    }
  }
}

/**
 * Après la modification ou la création d'un composant, coupe tout les fil qui sont connecter
 * avec le composant. Cette méthode complète {@link couperFil} pour toute les situations où un
 * composant n'est pas perpendiculaire avec le fil
 * @param {Composant} composant 
 * @param {Array} actions 
 */
function verifierSplitNewComposant(composant, actions) {
  let connections = composant.getConnections();
  let left = filStart(connections[0].x, connections[0].y, false);
  let right = filStart(connections[1].x, connections[1].y, false);
  let bornes = [left, right];
  for (let index = 0; index &lt; bornes.length; index++) {
    const borne = bornes[index];
    const connection = connections[index];
    if (borne != null) {
      for (const element of borne) {
        if (!((element.xi == connection.x &amp;&amp; element.yi == connection.y) ||
          (element.xf == connection.x &amp;&amp; element.yf == connection.y))) {
          splitFil(element, actions, connection);
        }
      }
    }
  }
}


/**
 * Coupe un fil en deux nouveau fils. Supprime aussi l'ancien fil du répertoire
 * @param {Fil} fil 
 * @param {Array} actions 
 * @param {object} borneSeparation1 Borne de fin du nouveau fil 1. Peut aussi servir de borne
 * de début du deuxième fil
 * @param {object} [borneSeparation2] Borne optionnel du début du nouveau fil 2. 
 * @return {Array} Les nouveaux fils
 */
function splitFil(fil, actions, borneSeparation1, borneSeparation2) {
  borneSeparation2 ??= borneSeparation1;
  let fil1 = new Fil(fil.xi, fil.yi, borneSeparation1.x, borneSeparation1.y);
  let fil2 = new Fil(borneSeparation2.x, borneSeparation2.y, fil.xf, fil.yf);
  let index = fils.indexOf(fil);
  fils.splice(index, 1);
  fils.push(fil1, fil2);
  actions.push({ type: SUPPRIMER, objet: fil, index },
    { type: CREATE, objet: fil1 }, { type: CREATE, objet: fil2 });
  return [fil1, fil2];
}

/**
 * Fonction permettant d'appliquer la règle qu'un fil doit toujours se connecter à un 
 * autre fil ou au borne d'un composant. Dans cette fonction, on vérifier qu'un composant
 * connecte avec un fil et si c'est le cas, on change si nécéssaire les valeur de positions
 * des bornes du fil pour qu'il connecte au composant ou on le supprime tout simplement
 * @param {Fil} fil Le fil que l'on veut comparer
 * @param {Composant} composant Le composant que l'on veut comparer
 * @param {Array} actions La liste d'actions ou l'on va enregistrer les actions 
 * interne effectuer dans la fonction
 * @returns Un boolean qui dit si le fil a été supprimer du répertoire. Très important si c'est un
 * nouveau fil (voir verifierCouperFil)
 */
function couperFil(fil, composant, actions) {
  let penteFil = Math.abs(fil.pente());
  let horizontal = composant.orientation % PI === 0;
  if ((penteFil == Infinity &amp;&amp; !horizontal) || (penteFil == 0 &amp;&amp; horizontal)) {
    const index = fils.indexOf(fil);
    let piInBound = composant.inBounds(fil.xi, fil.yi);
    let pfInBound = composant.inBounds(fil.xf, fil.yf);
    let connections = composant.getConnections();
    let borne1 = connections[0];
    let borne2 = connections[1];
    if (piInBound &amp;&amp; pfInBound) {
      //supprimer le fil
      fils.splice(index, 1);
      actions.push({ type: SUPPRIMER, objet: fil, index });
      return false;
    } else if (piInBound &amp;&amp; !pfInBound) {
      //Raccourcir le fil pour le point initial
      actions.push({
        type: MODIFIER,
        objet: fil,
        changements: [
          { attribut: 'xi', ancienne_valeur: fil.xi, nouvelle_valeur: borne2.x },
          { attribut: 'yi', ancienne_valeur: fil.yi, nouvelle_valeur: borne2.y }
        ]
      });
      fil.xi = borne2.x;
      fil.yi = borne2.y;
    } else if (!piInBound &amp;&amp; pfInBound) {
      //raccourcir le fil pour le point final
      actions.push({
        type: MODIFIER,
        objet: fil,
        changements: [
          { attribut: 'xf', ancienne_valeur: fil.xf, nouvelle_valeur: borne1.x },
          { attribut: 'yf', ancienne_valeur: fil.yf, nouvelle_valeur: borne1.y }
        ]
      });
      fil.xf = borne1.x;
      fil.yf = borne1.y;
    } else if (fil.inBoxBounds(composant.x, composant.y)) {
      let newFils = splitFil(fil, actions, borne1, borne2);
      verifierCouperFil(newFils[0], actions);
      verifierCouperFil(newFils[1], actions);
      return false;
    }
  }
  return true;
}

/**
 * Fonctionnalité permettant de colé la position d'un fil avec celle des bornes d'un composant.
 * Cette fonction va spécifiquement mettre à jour la position de chaque fil associé aux bornes
 * d'un composant en prennant em compte la précédente connection qu'il y avait avant le modification
 * du composant
 * @param {Array} borneG Tout les fils qui connecte avec la borne négative du composant
 * @param {Array} borneD Tout les fils qui connecte avec la borne postive du composant
 * @param {object} posReference Les bornes positives et négative précédente. 
 * Cette position sert à trouver quel borne du fil exactement il faut modifier (inital ou final)
 * @param {object} posUpdate Les bornes positives et négative mise-à-jour. Ce sont les valeurs
 * de positions que l'on veut mettre à jour dans les fils
 */
function updateFilPos(borneG, borneD, posReference, posUpdate) {
  let changeFil = (array, a, b) => {
    for (const element of array) {
      if (element.xi == a.x &amp;&amp; element.yi == a.y) {
        element.xi = b.x;
        element.yi = b.y;
      } else {
        element.xf = b.x;
        element.yf = b.y;
      }
    }
  }
  changeFil(borneG, posReference[0], posUpdate[0]);
  changeFil(borneD, posReference[1], posUpdate[1]);
}

/**
 * Enregistre dans une liste d'actions les changements effectuer sur les fils en liens avec
 * la fonctionnalité des fils ancré
 * @param {Array} borneG Tout les fils qui connecte avec la borne négative du composant
 * @param {Array} borneD Tout les fils qui connecte avec la borne postive du composant
 * @param {object} posReference Les bornes positives et négative précédente. 
 * Cette position sert à trouver quel borne du fil exactement a été modifier (inital ou final)
 * @param {object} posUpdate Les bornes positives et négative mise-à-jour. Ce sont les valeurs
 * de positions que l'on veut mettre à jour dans les fils
 * @param {Array} actions La liste d'action qui va être enregistrer dans {@link addActions}
 * @see updateFilPos 
 */
function setModificationFilPos(borneG, borneD, posReference, posUpdate, actions) {
  let addActionFil = function (array, a, b, actions) {
    for (const element of array) {
      let leftMod = element.xi == a.x &amp;&amp; element.yi == a.y;
      let x = leftMod ? 'xi' : 'xf';
      let y = leftMod ? 'yi' : 'yf';
      actions.push({
        type: MODIFIER,
        objet: element,
        changements: [
          { attribut: x, ancienne_valeur: b.x, nouvelle_valeur: a.x },
          { attribut: y, ancienne_valeur: b.y, nouvelle_valeur: a.y }
        ]
      });
    }
  }
  addActionFil(borneG, posReference[0], posUpdate[0], actions);
  addActionFil(borneD, posReference[1], posUpdate[1], actions);
}


/**
 * Met à jour les positions des noeuds et des connections.
 */
function updateNoeud() {
  noeuds.length = 0;
  let joinElement = fils.concat(components)
  for (const element of joinElement) {
    let connections = getAllConnection(element);
    if (!noeuds.includes(connections.left) &amp;&amp; connections.left.connections.length > 1) {
      noeuds.push(connections.left);
    }
    if (!noeuds.includes(connections.right) &amp;&amp; connections.right.connections.length > 1) {
      noeuds.push(connections.right);
    }
  }
}

/**
 * Cette fonction est l'équivalent de ajustementAutomatiqueFil, mais pour les composants.
 * Les actions qui peuvent être effectuer sont de remplacer un composant si deux composants
 * sont à la même position (remplacer le plus ancien par le nouveau) et de recouper les fils
 * si besoin (voir couperFil)
 * @param {Composant} composant Le nouveau composant à valider
 * @param {Array} actions La liste d'actions ou l'on va enregistrer les actions interne 
 * effectuer dans la fonction
 */
function ajustementAutomatiqueComposant(composant, actions) {
  let composantSuperpose = components.find(element => element !== composant &amp;&amp;
    element.x == composant.x &amp;&amp; element.y == composant.y);
  if (composantSuperpose != null) {
    let index = components.indexOf(composantSuperpose);
    components.splice(index, 1);
    actions.push({ type: SUPPRIMER, objet: composantSuperpose, index });
  }
  for (const fil of fils) {
    if (fil.isPenteConstante())
      couperFil(fil, composant, actions)
  }
  verifierSplitNewComposant(composant, actions);
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Mon May 22 2023 21:44:06 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
